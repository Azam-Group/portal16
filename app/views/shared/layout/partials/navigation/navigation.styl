
//navigation layout
nav {
	position absolute
	top 0
	overflow auto
	-webkit-overflow-scrolling: touch;
	height 100%
	width $drawer-width
}

+isBelow($laptop) {
	nav {
		left -($drawer-width)
		label {
			display block
			margin 0
		}
	}

	.siteCanvas {
		transition: left 500ms ease;
		position relative
		width 100%
		left 0
		&.hasActiveMenu {
			background pink
			left $drawer-width

			.menu-link {
				display none
			}
			.close-link {
				display inline-block
			}
		}
	}
}

+isAbove($laptop) {
	header {
		display none
	}
	nav {
		top 0
		left 0
		z-index 200
		height $navbar_height
		width 100%
		overflow visible
		padding-left 100px
		position fixed
		li {
			display inline-block
			label {
				padding 0 20px
			}
			&.isCategory {
				position initial
				> ul {
					// margin-top 50px
					display block
					background pink
					position absolute
					li {
						display block
					}
				}

				&.isMega {
					> ul {
						left 0
						right 0
						width 100% //500px
						padding 0 60px
						> li {
							padding-top 40px
							lost-column: 1 / 2
							// li {
							//      display block
							// }
						}
					}
				}
			}
		}
		.category-toggle:checked ~ .hide {
			color yellow
			&:after {
				content ''
				display: block;
				position: fixed;
				left: 0;
				right: 0;
				// background: #d13f19;
				height: 5000px;

			}
		}
	}
}





//mobile navigation content
+isBelow($laptop) {
	.SiteNav{
		//set base colors
		background $nav_drawer_bg
		color $nav_drawer_color
		
		//all list items should have the same padding
		li>a, .MainMenu>a {
			display block
			padding vr-block(0.5) vr-block(1) vr-block(0.5) vr-block(2)
			line-height vr-block(1)
		}
		>div {
			//draw a thin line between sections
			> * {
				box-shadow 0 1px 0 lighten($nav_drawer_bg, 5%) //used instead of border to keep the height
			}
			
			//items with icons need additional styling
			a {
				position relative
				&:before {
					font-size vr-block(1)
					position absolute
					left 10px
					top vr-block(0.5)
				}
				
				//add an overlay instead of dark color since background changes
				&:hover, &.isActive {
					background-color rgba(0,0,0,0.15)
					/*color lighten($nav_drawer_color, 50%)*/
				}
			}
			>ul>li>ul>li {
				>a {
					color darken($nav_drawer_color, 20%)
					/*padding vr-block(0.25) vr-block(1) vr-block(0.25) vr-block(3)*/
				}
				>ul>li>a {
					background darken($nav_drawer_bg, 8%)
					padding vr-block(0.25) vr-block(1) vr-block(0.25) vr-block(3)
				}
				>ul>li>ul>li>a {
					background darken($nav_drawer_bg, 16%)
					padding vr-block(0.25) vr-block(1) vr-block(0.25) vr-block(4)
				}
				
			}
			li {
				&.isCategory {
					>a {
						&:after {
							content '+'
							font-size (vr-block(1) / $perfect-fifth)
							font-family 'Helvetica'//gbificons
							position absolute
							right 10px
						}
					}
					> ul, >div>ul {
						position relative
						max-height 0
						overflow hidden
					}
					&.isExpanded {
						>a {
							&:after {
								content 'â€“'
							}
						}
						> ul, >div>ul {
							transition max-height 1.3s
							max-height 1000px
						}
					}
				}
			}
		}
	}
}

siteHeaderbar() {
	background $navbar_bg
	height $navbar_height
	border-bottom $navbar_borderWidth solid $navbar_BorderColor
	z-index 200
	color $navbar_textColor
}

+isAbove($laptop) {
	.SiteNav {
		siteHeaderbar()
	}
}


//navigation interaction
.isCategory > ul {
	max-height 0
	overflow hidden
	margin 0
}

.isCategory.isExpanded {
	> ul {
		transition: max-height 500ms ease;
		max-height 500px
	}
}

//TMP
// .MainMenu {
// 	display none
// }


actionIcon(){
	display inline-block
	padding vr-block(1.5) vr-block(1) vr-block(0.25) vr-block(1)
	relative()
	height vr-block(2.75)
	font-size (100 /$major-third) %
	line-height vr-block(1)
	&:before {
		display block
		width 100%
		text-align center
		absolute(top left)
		set-type(2)
		line-height vr-block(0)
		margin-top vr-block(1)
	}
}
a.actionIcon {
	actionIcon()
}


//service menu
+isBelow($laptop) {
	.ServiceMenu {
		.ServiceMenu__teaser {
			height vr-block(6)
			width 100%
			background url("http://wordlesstech.com/wp-content/uploads/2011/09/Wing-Secrets-mothwing.jpg")
			background-size cover
			position relative
			.ServiceMenu__teaser__message {
				line-height vr-block(1.5)
				padding 0 vr-block(0.5)
				font-size (100 /$major-second) %
				position absolute
				bottom 0
				background rgba(0,0,0,0.5)
				width 100%
				&:after {
					display block
					content '+'
					position absolute
					right vr-block(0.5)
					top 0
				}
			}
		}
	}
}

//only beacuse ther isn't a js service to load user and such yet.
@keyframes fadeInOut {
	0% {
		opacity: 0;
		right 50px
	}
	20% {
		opacity: 0;
	}
	30% {
		opacity: 1;
	}
	84% {
		opacity: 1;
	}
	99% {
		right 50px
	}
	100% {
		opacity: 0;
		right -9999px;
	}
}

+isAbove($laptop) {
	.ServiceMenu {
		position absolute
		right 0
		li {
			display inline-block
		}
		.ServiceMenu__teaser {
			position absolute
			top 100px
			width auto
			white-space nowrap
			padding 10px
			opacity 0
			animation: fadeInOut 5s;
			// transition: opacity 3s ease-in-out;
			// opacity 0
			background deepskyblue
		}
		>ul>li>a {
			actionIcon()
		}
	}
}

//can there be multilayer menu and push on desktop
+isBelow($laptop) {
	.ServiceMenu > ul {
		// position relative //include image drawer header?
	}
	.isOwnMenu {
		left -100%
		transition: left 500ms ease;
		position absolute
		top 0
		background pink
		width 100%
		height 100%
		> a {
			background #333
			display block //visual
			&:before {
				content 'back '
			}
		}
		&.isActive {
			left 0%
		}
	}
}

+isAbove($laptop) {
	.isOwnMenu {
		> ul {
			top $navbar_height
			right -300px
			transition: right 500ms ease;
			position absolute
			background pink
			width 300px
			height "calc(100vh - %s)" % $navbar_height
			> a {
				background #333
				display block //visual
				&:before {
					content 'back '
				}
			}
		}
		&.isActive > ul {
			right 0px
		}
	}
}



















main {
	//position 0 simply to avoid reflows that could be expensive
	position absolute
	top $navbar_height
	width 100%
	height "calc(100vh - %s)" % $navbar_height
	// overflow hidden
}

.contentArea {
	background yellow
	position relative //to be pushable by the filter drawer
	overflow hidden
	transition: right 500ms ease;
}
+isBelow($laptop) {
	.contentArea {
		height: 100%
		right 0 //to make the transitition smooth we need a starting position
		
		.contentArea__main {
			-webkit-overflow-scrolling: touch;
			overflow auto
			height 100%
		}
	}

}
+isAbove($laptop) {
	.contentArea__main {
		padding-left 85px
	}

}





//FILTERS

//use sibling elements

main > aside {
	right 0
	width $drawer-width
	position absolute
	top 0px
	transition: right 500ms ease;
	height "calc(100vh - %s)" % $navbar_height
	right 0

	background pink
	overflow hidden
	> div {
		height 100%
		background #333
		color #ddd
		overflow auto
		-webkit-overflow-scrolling touch
	}
	&:target {
		~ .contentArea {
			right $drawer-width
			overflow hidden
		}
	}
}





forceShowDrawer() {
	transition initial
	left 0
	~ .contentArea {
		padding-left $drawer-width
	}
	&:target ~ .contentArea {
		left 0
	}
}
+isAbove($laptop) {
	main > aside {
		z-index 20
		right initial
		left -($drawer-width)
		transition: left 500ms ease;
		position fixed
		top $navbar_height
		~ .contentArea {
			transition: left 500ms ease;
			left 0
		}
		&:target {
			right initial
			left 0
			/*~ .contentArea {*/
				/*right initial*/
				/*left $drawer-width*/
			/*}*/
		}
		&.isLocked {
			forceShowDrawer()
		}
	}
}
+isAbove($desktop) {
	main > aside {
		forceShowDrawer()
	}
}
